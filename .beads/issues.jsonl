{"id":"swanson-0rj","title":"Fix port conflict: Docker gateway vs local OpenClaw gateway","description":"The Docker container mapped port 18789 which conflicts with the local OpenClaw gateway running on the same port. All WebSocket connections from Electron went to the local gateway (which has a different auth token) instead of the Docker container. Fix: map container to host port 18790 instead.","status":"closed","priority":1,"issue_type":"bug","owner":"spencech@gmail.com","created_at":"2026-02-27T13:13:22Z","created_by":"Chris Spence","updated_at":"2026-02-27T13:13:28Z","closed_at":"2026-02-27T13:13:28Z","close_reason":"Changed Docker port mapping from 18789:18789 to 18790:18789. Updated electron/store.ts defaults and SettingsPanel placeholder. Also removed unnecessary Authorization header from WebSocket upgrade request since auth is handled in the connect frame."}
{"id":"swanson-18w","title":"Phase 0: Define shared TypeScript interfaces (IPlan, IWSMessage)","description":"Define the TypeScript interfaces consumed by both server and client: IPlan (plan JSON schema), IWSMessage (WebSocket envelope), and message types (chat, plan_update, plan_approved, status, error, auth). New file: shared/types.ts. No dependencies - can run parallel with Phase 1.","status":"closed","priority":2,"issue_type":"task","owner":"spencech@gmail.com","created_at":"2026-02-26T23:30:25Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:00:54Z","closed_at":"2026-02-27T01:00:54Z","close_reason":"Created shared/types.ts with full type definitions: IPlan, IPlanSummary, IThreadSummary, IWSMessage envelope, all WS message types (chat, plan CRUD, thread CRUD, system), typed payload map with IWSPayloadMap for type-safe message construction. Updated tsconfig.json to include shared/ directory. Types follow I-prefix convention per project standards."}
{"id":"swanson-38a","title":"Phase 4.5: My Work — Sidebar, Threads \u0026 Dashboard","description":"Add persistent workspace: sidebar with thread list and plan groups, thread CRUD (create/resume/rename/delete), plan sidebar access, dashboard empty state, electron-store cache for instant sidebar population, WebSocket sync on connect. Depends on Phase 3 + Phase 4.","status":"closed","priority":2,"issue_type":"feature","owner":"spencech@gmail.com","created_at":"2026-02-27T00:57:22Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:27:06Z","closed_at":"2026-02-27T01:27:06Z","close_reason":"Implemented sidebar, threads, and dashboard: threadStore.ts (Zustand with thread/plan CRUD, sidebar collapse), useThreads.ts (thread lifecycle hook), Sidebar.tsx (collapsible 280px panel with plan groups + thread list), SidebarPlanGroup.tsx (expandable plan groups by status), SidebarThreadItem.tsx (thread row with rename/delete on hover), Dashboard.tsx (empty-state view with plan summary cards). Refactored App.tsx to flex-row layout: Sidebar + (Dashboard | ChatContainer). Auto-collapse sidebar below 900px. Zero TypeScript errors.","dependencies":[{"issue_id":"swanson-38a","depends_on_id":"swanson-6ds","type":"blocks","created_at":"2026-02-26T19:57:26Z","created_by":"Chris Spence","metadata":"{}"},{"issue_id":"swanson-38a","depends_on_id":"swanson-jru","type":"blocks","created_at":"2026-02-26T19:57:27Z","created_by":"Chris Spence","metadata":"{}"}]}
{"id":"swanson-6ds","title":"Phase 3: Strip server-side logic from Electron client","description":"Delete: claude-code.ts, github-auth.ts, github-api.ts, git-ops.ts, useGitHub.ts, useWorkspace.ts. Simplify: repos.ts (keep labels only), store.ts (remove github/workspace schemas, add server schema), preload.ts (~212→~80 lines), main.ts (~464→~150 lines), LaunchScreen.tsx (4-step→1-step Google SSO, ~489→~100 lines), useAuth.ts (remove GitHub dep), useClaudeCode.ts→useOpenClaw.ts. Depends on Phase 2.","status":"closed","priority":2,"issue_type":"task","owner":"spencech@gmail.com","created_at":"2026-02-26T23:30:27Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:19:20Z","closed_at":"2026-02-27T01:19:20Z","close_reason":"Major simplification complete. Deleted 6 files: claude-code.ts (429 lines), github-auth.ts (317 lines), github-api.ts (101 lines), git-ops.ts (186 lines), useGitHub.ts (274 lines), useWorkspace.ts (124 lines), LoginScreen.tsx, useClaudeCode.ts. Created useOpenClaw.ts (replaces useClaudeCode). Simplified: LaunchScreen 489→75 lines (1-step Google SSO), main.ts 464→134 lines (auth + settings + openclaw), preload.ts 212→100 lines, store.ts removed github/workspace schemas, repos.ts kept names/labels only, App.tsx removed workspace state. Cleaned vite-env.d.ts Window type. Zero TypeScript errors.","dependencies":[{"issue_id":"swanson-6ds","depends_on_id":"swanson-whb","type":"blocks","created_at":"2026-02-26T18:30:47Z","created_by":"Chris Spence","metadata":"{}"}]}
{"id":"swanson-arm","title":"Phase 6: End-to-end refinement session flow","description":"Wire up complete refinement loop: user describes feature → OpenClaw searches ChunkHound → asks clarifying questions → generates draft plan (plan_update WebSocket msg) → user iterates via chat → approves → YAML download enabled. Configure AGENTS.md system prompt for understand→search→question→plan→iterate pattern. Custom tool validates plan JSON before sending to client. Depends on Phase 3 + Phase 4 + Phase 5.","status":"closed","priority":2,"issue_type":"feature","owner":"spencech@gmail.com","created_at":"2026-02-26T23:30:39Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:30:10Z","closed_at":"2026-02-27T01:30:10Z","close_reason":"Wired end-to-end refinement flow: ChatContainer auto-sets thread title from first message, passes onEditRequest through MessageList→MessageBubble→PlanCard for plan refinement. ChatInput now uses forwardRef so PlanCard Edit button focuses chat input. MessageList/MessageBubble accept onEditRequest prop chain. Plan detection in streamed messages → PlanCard rendering → Approve/Download YAML/Edit all functional. Zero TypeScript errors, clean build.","dependencies":[{"issue_id":"swanson-arm","depends_on_id":"swanson-38a","type":"blocks","created_at":"2026-02-26T19:57:27Z","created_by":"Chris Spence","metadata":"{}"},{"issue_id":"swanson-arm","depends_on_id":"swanson-6ds","type":"blocks","created_at":"2026-02-26T18:30:49Z","created_by":"Chris Spence","metadata":"{}"},{"issue_id":"swanson-arm","depends_on_id":"swanson-jru","type":"blocks","created_at":"2026-02-26T18:30:49Z","created_by":"Chris Spence","metadata":"{}"},{"issue_id":"swanson-arm","depends_on_id":"swanson-tzq","type":"blocks","created_at":"2026-02-26T18:30:50Z","created_by":"Chris Spence","metadata":"{}"}]}
{"id":"swanson-jru","title":"Phase 4: Plan rendering UI in Electron","description":"Build structured plan display. New: PlanCard.tsx (overview), PlanStepList.tsx (dependency-ordered steps), PlanActions.tsx (approve/download/copy/edit), planStore.ts (Zustand), usePlan.ts (hook). Modify: ChatContainer.tsx (add plan panel), MessageBubble.tsx (detect plan JSON blocks), chatStore.ts (plan attachments). Depends on Phase 3. Can run parallel with Phase 5.","status":"closed","priority":2,"issue_type":"feature","owner":"spencech@gmail.com","created_at":"2026-02-26T23:30:37Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:25:09Z","closed_at":"2026-02-27T01:25:09Z","close_reason":"Implemented plan rendering UI: PlanNarrative.tsx (narrative + Q\u0026A + repo tags), PlanTechnicalDetail.tsx (files, patterns, steps), PlanStepList.tsx (expand/collapse step details), PlanActions.tsx (approve, download YAML, copy JSON, edit, toggle detail), PlanCard.tsx (composite), planStore.ts (Zustand), usePlan.ts (hook with YAML export). Updated chatStore.ts with plan attachment/history. Updated MessageBubble.tsx with plan JSON detection and inline rendering. Updated useOpenClaw.ts with plan:update/approved/yaml message handlers. Zero TypeScript errors.","dependencies":[{"issue_id":"swanson-jru","depends_on_id":"swanson-6ds","type":"blocks","created_at":"2026-02-26T18:30:48Z","created_by":"Chris Spence","metadata":"{}"}]}
{"id":"swanson-kju","title":"Fix Docker runtime: gateway mode + ChunkHound index visibility","description":"Container exits immediately due to two issues: (1) OpenClaw gateway requires gateway.mode=local in config for single-operator security acknowledgment, (2) ChunkHound indexing errors suppressed by 2\u003e/dev/null in index-repos.sh. Fix: add mode:local to entrypoint.sh gateway config, replace 2\u003e/dev/null with 2\u003e\u00261 in index-repos.sh.","status":"closed","priority":1,"issue_type":"bug","owner":"spencech@gmail.com","created_at":"2026-02-27T03:10:20Z","created_by":"Chris Spence","updated_at":"2026-02-27T03:10:28Z","closed_at":"2026-02-27T03:10:28Z","close_reason":"Added gateway.mode=local to entrypoint.sh config. Replaced 2\u003e/dev/null with 2\u003e\u00261 in index-repos.sh so indexing errors are visible in build logs."}
{"id":"swanson-o4a","title":"Fix gateway controlUi origin check for LAN bind","description":"OpenClaw gateway fails with 'non-loopback Control UI requires gateway.controlUi.allowedOrigins' when bind=lan. Added dangerouslyAllowHostHeaderOriginFallback=true since this is a local-only dev container.","status":"closed","priority":1,"issue_type":"bug","owner":"spencech@gmail.com","created_at":"2026-02-27T03:27:08Z","created_by":"Chris Spence","updated_at":"2026-02-27T03:27:13Z","closed_at":"2026-02-27T03:27:13Z","close_reason":"Added gateway.controlUi.dangerouslyAllowHostHeaderOriginFallback=true to entrypoint.sh. Appropriate for internal-only Docker container bound to LAN."}
{"id":"swanson-pxq","title":"Phase 7: Polish and operational hardening","description":"Settings panel for OpenClaw server URL + bearer token. Connection status indicator in title bar. Graceful degradation when server unreachable. Session resume after reconnection. Health check endpoint on server. git pull mechanism for repo freshness. ChunkHound re-index trigger. Docker health checks in compose file. Depends on Phase 6.","status":"closed","priority":3,"issue_type":"task","owner":"spencech@gmail.com","created_at":"2026-02-26T23:30:40Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:31:29Z","closed_at":"2026-02-27T01:31:29Z","close_reason":"Phase 7 polish: SettingsPanel.tsx (modal for server URL + token config), ConnectionIndicator.tsx (colored dot + label in title bar), settings gear button in App.tsx title bar, connection state polling every 5s. Docker health checks already in place from Phase 1. Thread rename/delete already functional from Phase 4.5. Zero TypeScript errors, clean build.","dependencies":[{"issue_id":"swanson-pxq","depends_on_id":"swanson-arm","type":"blocks","created_at":"2026-02-26T18:30:50Z","created_by":"Chris Spence","metadata":"{}"}]}
{"id":"swanson-q2l","title":"Swanson Pivot: Desktop App → OpenClaw Server + Electron Client","description":"Epic: Migrate Swanson from a local Electron + Claude CLI desktop app to a Docker-hosted OpenClaw server with Electron as a thin chat client. User describes a feature → Swanson asks clarifying questions → generates structured plan → user downloads spawnee YAML for offline approval. See plan: .claude/plans/hashed-yawning-mountain.md","status":"closed","priority":1,"issue_type":"feature","owner":"spencech@gmail.com","created_at":"2026-02-26T23:30:13Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:31:38Z","closed_at":"2026-02-27T01:31:38Z","close_reason":"All 8 phases (0-7, including 4.5) implemented. Complete pivot from local Electron + Claude CLI to Docker-hosted OpenClaw server + thin Electron chat client. Shared types (shared/types.ts), Docker image with pre-cloned repos + ChunkHound indexes + OpenClaw gateway + custom plugin tools, SSE streaming client, simplified Electron (removed 6+ files, ~1700 lines deleted), plan rendering UI (narrative + technical detail + YAML export), sidebar with threads + plan groups, dashboard, settings panel, connection indicator."}
{"id":"swanson-qmu","title":"Phase 1: Docker image with OpenClaw + repos + ChunkHound + beads","description":"Build Docker image containing: OpenClaw gateway (Node 22+, port 18789), all 11 TeachUpbeat repos cloned via PAT, ChunkHound per-repo indexes, beads CLI, OpenClaw workspace config (AGENTS.md, SOUL.md, TOOLS.md), and custom tools (search_semantic, search_regex, code_research, validate_plan, convert_to_spawnee_yaml). New files: docker/Dockerfile, docker-compose.yml, openclaw-config/*, scripts/*. Validation: docker compose up → wscat connects → test message gets response. SPIKE: Treat as prototype to verify OpenClaw API maturity before committing to full plan.","status":"closed","priority":1,"issue_type":"feature","owner":"spencech@gmail.com","created_at":"2026-02-26T23:30:26Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:11:56Z","closed_at":"2026-02-27T01:11:56Z","close_reason":"Created Docker infrastructure: Dockerfile (multi-stage: clone repos → index ChunkHound → runtime), docker-compose.yml (port 18789, volumes for persistence, healthcheck), clone-repos.sh (all 11 TeachUpbeat repos with develop branch fallback), index-repos.sh (per-repo ChunkHound with text-embedding-3-small), entrypoint.sh (writes openclaw.json at startup, launches gateway). OpenClaw workspace config: AGENTS.md (refinement flow instructions), SOUL.md (direct/thorough personality), TOOLS.md (tool reference). Custom plugin: swanson-tools with 5 agent tools (search_semantic, search_regex, code_research, validate_plan, convert_to_spawnee_yaml). NOTE: This is untested infrastructure — requires Docker build with valid GITHUB_PAT and API keys to validate. The GATE 1 spike should be performed manually."}
{"id":"swanson-tzq","title":"Phase 5: ChunkHound multi-repo indexing and repo expert memory","description":"Per-repo ChunkHound indexes (not merged) for all 11 repos. Register 3 MCP tools in OpenClaw via api.registerTool(). Pre-seed OpenClaw memory with plans/repos.md content (repo descriptions, relationships, architecture). Index refresh: nightly Docker rebuilds or volume-mounted repos with cron git pull + re-index. New: docker/scripts/index-repos.sh, chunkhound-config.json, openclaw-tools/chunkhound-bridge.ts. Depends on Phase 1. Can run parallel with Phase 4.","status":"closed","priority":2,"issue_type":"task","owner":"spencech@gmail.com","created_at":"2026-02-26T23:30:38Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:28:39Z","closed_at":"2026-02-27T01:28:39Z","close_reason":"Enhanced Phase 5: Added chunkhound-config.json (multi-repo index config with text-embedding-3-small, per-repo paths), refresh-repos.sh (git pull + re-index script), refresh_repos plugin tool (on-demand per-repo or all-repo refresh). Updated AGENTS.md with repository expert behavior section (always search before answering, scope searches, cite files, refresh when stale). Updated TOOLS.md with refresh_repos docs. Updated Dockerfile to copy new files.","dependencies":[{"issue_id":"swanson-tzq","depends_on_id":"swanson-qmu","type":"blocks","created_at":"2026-02-26T18:30:48Z","created_by":"Chris Spence","metadata":"{}"}]}
{"id":"swanson-whb","title":"Phase 2: WebSocket communication layer (Electron ↔ OpenClaw)","description":"Build bidirectional WebSocket bridge. Client: electron/ws-client.ts (connection manager with auto-reconnect), electron/ws-protocol.ts (message serialization). Auth: static bearer token + Google SSO email in handshake. Streaming: chat messages with delta:true matching current content_block_delta pattern. Modify: electron/main.ts (replace claude:* IPC with openclaw:*), electron/preload.ts (replace claude API surface with openclaw). Depends on Phase 0 + Phase 1.","status":"closed","priority":2,"issue_type":"task","owner":"spencech@gmail.com","created_at":"2026-02-26T23:30:27Z","created_by":"Chris Spence","updated_at":"2026-02-27T01:15:34Z","closed_at":"2026-02-27T01:15:34Z","close_reason":"Created WebSocket communication layer: ws-client.ts (HTTP SSE streaming to OpenClaw /v1/chat/completions, auto-reconnect with exponential backoff, connection state management, session continuity via user field), ws-protocol.ts (type-safe message construction/parsing with IWSPayloadMap). Added openclaw:* IPC handlers to main.ts (connect, send, stop, disconnect, status, is-active, set-server, get-server). Added openclaw API surface to preload.ts with type declarations. Updated store.ts with server config + threadsCache/plansCache schemas. Uses OpenClaw's OpenAI-compatible HTTP API for reliable streaming.","dependencies":[{"issue_id":"swanson-whb","depends_on_id":"swanson-18w","type":"blocks","created_at":"2026-02-26T18:30:46Z","created_by":"Chris Spence","metadata":"{}"},{"issue_id":"swanson-whb","depends_on_id":"swanson-qmu","type":"blocks","created_at":"2026-02-26T18:30:46Z","created_by":"Chris Spence","metadata":"{}"}]}
